\documentclass[preprint,russian,a5paper,10pt,twoside]{ncc}
\usepackage[utf8]{inputenc}
\usepackage{misccorr}			% различные особенности оформления документов, принятые в России
\usepackage{indentfirst}		% начинать абзац с красной строки
\usepackage{tikz}				% рисование чертежей
\usetikzlibrary{positioning}	% автоматическое размещение элементов на чертежах относительно друг друга
\usetikzlibrary{shapes.misc}
\usepackage{enumitem}			% Для разрывов в списках
%\usepackage{dcounter}			% динамические счётчики
%\usepackage{amsmath}
%\usepackage{nccmath}

\pagestyle{plain}

%********Команда все примеры подчеркиваем
\newcommand{\ExampleMy}{\textbf{\underline{Пример:}}}
%*********

\countstyle{section}			% посекционная нумерация

\begin{document}

\begin{titlepage}
	\titlehead{\footnotesize САНКТ-ПЕТЕРБУРГСКИЙ\\ ГОСУДАРСТВЕННЫЙ ПОЛИТЕХНИЧЕСКИЙ УНИВЕРСИТЕТ\par\vspace{1mm} ИНСТИТУТ ИНФОРМАЦИОННЫХ ТЕХНОЛОГИЙ И УПРАВЛЕНИЯ\par\vspace{1mm} КАФЕДРА КОМПЬЮТЕРНЫХ СИСТЕМ\\ И ПРОГРАММНЫХ ТЕХНОЛОГИЙ}
	\titlefoot{Санкт-Петербург\\ \theyear}
	\author{С.\=,А.~Нестеров}
	\title{СИСТЕМЫ ОПТИМАЛЬНОГО УПРАВЛЕНИЯ}
	\titlecomment{Конспект лекций}
	\maketitle
\end{titlepage}

\setcounter{page}{2}
\thispagestyle{empty}
\mbox{}\newpage
\tableofcontents
\newpage

\setcounter{secnumdepth}{-1}		% отключили нумерацию разделов
\section{Введение\label{intro}}
\setcounter{secnumdepth}{2}		% включили обратно

Для начала определимся, что понимается под управлением. Существует три фундаментальных принципа управления:
\begin{itemize}
\item Управление по заданию --- необходимо получить заданный сигнал $v$ на выходе объекта управления (ОУ). Для этого передаточная функция системы управления в целом (см. рис.~\ref{fig:intro:control_by_target}) должна быть равна единице. Тогда передаточная функция уст\-ройства управления (УУ) равна:
\begin{equation}\label{equ:intro:control_by_target}
W_{\text{\textit{УУ}}}=\frac{1}{W_{\text{\textit{ОУ}}}}
\end{equation}

\begin{figure}[ht] \centering		% [ht] - размещение в указанном месте, а если невозможно, то вверху следующей страницы
\begin{tikzpicture}											% здесь размеры по умолчанию в см
	[	auto,												% чтобы элементы чертежа не пересекались
		inner sep = 2ex,									% пространство, оставляемое вокруг текста
		block/.style={rectangle,draw=black,thick},		% стиль отрисовки блока
		vec/.style={->,>=stealth,semithick},				% стиль отрисовки вектора
		point/.style={inner sep = 0pt}	]
	\node[block] (object) {$ W_{\text{\textit{ОУ}}} $};	% Ставить ; обязательно! ИНАЧЕ ВСЁ ВИСНЕТ!!!!1
	\node[block] (regulator) [left = of object] {$ W_{\text{\textit{УУ}}} $};
%	\draw[vec] (regulator) to (object);					% вектор без подписи
	\draw[vec] (regulator) to node{$u$} (object);			% вектор с подписью
	\node[point] (input) [left = of regulator] {};
	\draw[vec] (input) to node{$v$} (regulator);
	\node[point] (output) [right = of object] {};
	\draw[vec] (object) to node{$x$} (output);
\end{tikzpicture}
\footnotesize \caption{Управление по заданию\label{fig:intro:control_by_target}}
\end{figure}

\item Управление по возмущению --- возмущения $f$, действующие на объект, учитываются при формировании управляющего воздействия $u$ (см. рис.~\ref{fig:intro:control_by_noise}). Передаточная функция от возмущений к выходу может быть выражена как $ W_{fu}W_\text{\textit{ОУ}}+W_{fx} $ и должна быть равна нулю. Тогда передаточная функция от возмущений к управлению равна:
\begin{equation}\label{equ:intro:control_by_noise}
W_{fu}=-\frac{W_{fx}}{W_\text{\textit{ОУ}}}
\end{equation}

\begin{figure}[ht] \centering
\begin{tikzpicture}	
	[	auto, inner sep = 2ex,
		block/.style={rectangle,draw=black,thick},
		vec/.style={->,>=stealth,semithick},
		point/.style={inner sep = 0pt}	]
	\node[block] (object) {$ W_\text{\textit{ОУ}} $};
	\node[block] (regulator) [left = of object] {$ W_\text{\textit{УУ}} $};
	\draw[vec] (regulator) to node{$u$} (object);
	\node[point] (input) [left = of regulator] {};
	\draw[vec] (input) to node{$v$} (regulator);
	\node[point] (output) [right = of object] {};
	\draw[vec] (object) to node{$x$} (output);
	\node[point] (noise) [above = of object] {};
	\draw[vec] (noise) to node(f){$f$} (object);
	\draw[vec] (f.west) -| (regulator.north);
	\fill (f.west) circle (1pt);
\end{tikzpicture}
\footnotesize \caption{Управление по возмущению\label{fig:intro:control_by_noise}}
\end{figure}

\item Управление по ошибке --- на вход регулятора подаётся отклонение $e$ выходного сигнала объекта $x$ от сигнала задания $v$ (см. рис.~\ref{fig:intro:control_by_eps}). Если $e$ устремить к нулю, то передаточная функция от $e$ к $x$ должна устремиться к бесконечности, чтобы получить на выходе заданную величину:
\begin{equation}\label{equ:intro:control_by_eps}
W_\text{\textit{УУ}}W_\text{\textit{ОУ}}\longrightarrow\frac{x_\text{\textit{уст}}}{0}=\infty
\end{equation}

Этого можно добиться, например, введением в регулятор очень больших коэффициентов усиления или интегрирующих звеньев.

\begin{figure}[ht] \centering
\begin{tikzpicture}	
	[	auto, inner sep = 2ex,
		block/.style={rectangle,draw,thick},
		vec/.style={->,>=stealth,semithick},
		point/.style={inner sep = 0pt}	]
	\node[block] (object) {$ W_\text{\textit{ОУ}} $};
	\node[block] (regulator) [left = of object] {$ W_\text{\textit{УУ}} $};
	\draw[vec] (regulator) to node{$u$} (object);
	\node[circle,draw,thick,inner sep=0pt,minimum size=2ex] (sum) [left = of regulator] {};
	\draw[semithick] (sum.north west) -- (sum.south east);
	\draw[semithick] (sum.south west) -- (sum.north east);
	\fill (sum.center) -- (sum.south west) arc (-135:-45:1ex) -- cycle;
	\draw[vec] (sum) to node{$e$} (regulator);
	\node[point] (input) [left = of sum] {};
	\draw[vec] (input) to node{$v$} (sum);
	\node[point] (output) [right = of object] {};
	\draw[vec] (object) to node(x){$x$} (output);
	\node[point] (p1) [below=of sum] {};
	\draw (x.south) |- (p1.center) [vec] to (sum);
	\fill (x.south) circle (1pt);
\end{tikzpicture}
\footnotesize \caption{Управление по ошибке\label{fig:intro:control_by_eps}}
\end{figure}
\end{itemize}
% Смотри формулу~\eqref{equ:intro:control_by_target}, с.~\pageref{equ:intro:control_by_target}.
% А теперь смотри рисунок~\ref{fig:intro:control_by_target}, с.~\pageref{fig:intro:control_by_target}.

По решаемой задаче системы автоматического управления (САУ) можно разделить на системы:
\begin{itemize}
\item стабилизации
\item программного управления
\item слежения
\item оптимального управления
\item адаптивного управления (поисковые и самонастраивающиеся)
\end{itemize}

Анализ и синтез САУ предполагает, что кроме цели рассматривается путь решения задачи. Для этого используются различные показатели качества:
\begin{itemize}
\item Прямые:
	\begin{itemize}
	\item Статические: статизм, добротность;
	\item Динамические: время переходного процесса, перерегулирование, колебательность;
	\end{itemize}
\item Косвенные:
	\begin{itemize}
	\item Корневые;
	\item Частотные;
	\item Интегральные.
	\end{itemize}
\end{itemize}

Существует два основных подхода к синтезу САУ:
\begin{enumerate}
\item Обеспечить заданные показатели качества;
\item Обеспечить наилучшее (оптимальное) в каком-либо определённом смысле качество управления для заданного объекта при конкретных условиях работы и ограничениях.
\end{enumerate}

Эти два подхода имеют право на жизнь и естественно широко применяются. При этом надо понимать, что второй подход даёт максимально возможный (в отличие от первого, который даёт минимально пригодный) результат. Однако, за предельно достижимое качество необходимо будет чем-то \glqq заплатить\grqq. Поэтому должно быть оценено, что даёт выигрыш в качестве и чем за это надо \glqq заплатить\grqq. Соответственно, дальнейшее и посвящено рассмотрению теоретических моментов по расчёту и реализации соответствующих систем.

При решении такой задачи естественно требовать от управляемого процесса (ОУ) выполнения условий полной управляемости и наблюдаемости.

\clearpage		% выводит все накопившиеся плавающие элементы, а затем завершает страницу

\section{Постановка задачи оптимального управления\label{task}}

В общем случае постановки задач оптимального управления характеризуются значительным разнообразием, что связано с тремя основными причинами:
\begin{itemize}
\item Конкретными \glqq условиями\grqq функционирования, к которым следует отнести:
\begin{itemize}
\item начальное (исходное) и конечное (требуемое) состояния ОУ с временной привязкой $X_{0}\left ( t_{0} \right )$, $X_\text{\textit{к}}\left ( t_\text{\textit{к}} \right )$;
\item взаимосвязи, присущие реальным процессам, в форме:
\begin{itemize}
\item алгебраических (голономных) уравнений $G\left(x,u\right)=0$,
\item дифференциальных (неголономных) уравнений\\ $\varphi \left( x,u,t \right)=\dot{x}-Ax+Bu=0$,
\item интегральных (изопериметрических) уравнений\\ $I\left( x,u,t \right)=\int\limits_{t_0}^{t_\text{\textit{к}}}{\varphi \left( x,u,t \right)dt=C}$;
\end{itemize}
\end{itemize}
\item Ограничениями на управляющие сигналы и переменные состояния $\underline{U}\le U\le \overline{U}$; $\underline{X}\le X\le \overline{X}$; $\sum\limits_{i=1}^{n}{u_{i}^{2}}\le A$
\item Математическим видом критерия оптимальности.
\end{itemize}

Выбор критерия не является формальным актом, он не предписывается какой-либо теорией, а полностью определяется содержанием задачи управления. В общем виде критерий записывается функционалом:
\begin{equation}\label{equ:task:criterion_general}
J \left( U, X, \underset{t_\text{\textit{к}} - t_0}{\mathop{T}} \, \right) = \Phi \left( \underset{X_0, \, X_\text{\textit{к}}}{\mathop{ X \left( T \right) }} , T \right) + \int\limits_{t_0}^{t_\text{\textit{к}}} F\bigl( X(t), U(t), t \bigr) \, dt,
\end{equation}
где $ \Phi \bigl( X(T), T \bigr) $ --- терминальная составляющая, характеризующая качество управления только по начальному и конечному состояниям ОУ (поэтому отсутствует $U$); $ F \bigl( X(t), U(t), t \bigr) $ --- подынтегральная целевая функция, характеризующая качество внутри интервала управления. Управление должно обеспечивать экстремальное значение критерия оптимальности $ U = \underset{U}{\mathop{extr}} \, J \left( X, U, T \right) $. \smallskip 

Вид критерия $ J( X, U, T) $ задаёт класс задач оптимальности:
\begin{enumerate}
\item Критерий максимального быстродействия (минимального времени реакции):
\begin{enumerate}
\item[а)] $ \Phi \bigl( X(T), T \bigr) = T = t_\text{\textit{к}} - t_0 , \quad F\bigl( X(t), U(t), t \bigr) \equiv 0 $  
\item[б)] $ \Phi \bigl( X(T), T \bigr) \equiv 0 , \quad F\bigl( X(t), U(t), t \bigr) = 1 \to \int\limits_0^T 1\,dt = T $
\end{enumerate}

%\begin{subequations}\label{equ:task:minT}
%\renewcommand{\theequation}{\theparentequation\asbuk{equation}}
%\begin{equation}\label{equ:task:minT_first}
%y = x
%\end{equation}
%\begin{equation}\label{equ:task:minT_second}
%z = x^2(C+1)
%\end{equation}
%\end{subequations}

% оформление нескольких однострочных выносных формул, разделённых знаком \\
%\begin{subequations}\label{equ:task:minT}
%ahaha:
%\begin{gather}
%\Phi \bigl( x(T), T \bigr) = T = t_k - t_0 , \quad F\bigl( x(t), u(t), t \bigr) \equiv 0 \\
%\Phi \bigl( x(T), T \bigr) \equiv 0 , \quad F\bigl( x(t), u(t), t \bigr) = 1 \to \int\limits_0^T 1\,dt = T
%\end{gather}
%\end{subequations}

\item Критерий минимального расхода управления (топлива):
\[ \Phi \bigl( X(T), T \bigr) \equiv 0 , \quad F \bigl( X(t), U(t), t \bigr) = R \left| U \right| = \sum\limits_{i=1}^{n}{ r_i \left| u_i \right| } \]
\item Критерий предельной точности (минимальной ошибки):
\[ \Phi \bigl( X(T), T \bigr) \equiv 0, \quad F \bigl( X(t), U(t), t \bigr) = X^TQX, \] где $X$ --- отклонение (ошибка) от заданного значения, $Q$ --- матрица весовых коэффициентов (важность каждой составляющей в общей ошибке).
\item Критерий минимума энергетических затрат:
\[ \Phi \bigl( X(T), T \bigr) \equiv 0, \quad F \bigl( X(t), U(t), t \bigr) = U^TRU = \sum\limits_{i=1}^{n}{r_i u_i^2} \] на интервале $ t_\text{\textit{к}} - t_0 = T $
\item Критерий терминального управления (задача мягкой посадки или система управления конечным положением):
\[ \Phi \bigl( X(T), T \bigr) \ne 0, \quad F \bigl( X(t), U(t), t \bigr) \equiv 0 \]
\end{enumerate}

Часто используются смешанные варианты критериев:
\begin{enumerate}[resume]
%6
\item Квадратичный критерий качества управления (предельной точности при минимуме энергетических затрат):
\[ \Phi \bigl( X(T), T \bigr) \equiv 0, \quad F \bigl( X(t), U(t), t \bigr) = X^TQX + U^TRU \]
\item Критерий максимального быстродействия при минимальном расходе топлива (для управления автономными ОУ):
\[ \Phi \bigl( X(T), T \bigr) \equiv 0, \quad F \bigl( X(t), U(t), t \bigr) = 1 + R\left|U\right| = 1 + \sum\limits_{i=1}^{n}{ r_i \left| u_i \right| } \]
%8
\item Критерий минимизации энергетических затрат при фиксированном интервале времени и заданном состоянии: 
\[ J = X^T \left( T \right) S X \left( T \right) + \int\limits_0^T \left( X^TQX + U^TRU \right) \, dt \] 
\end{enumerate}

Постановки задачи с критерием общего вида (двумя слагаемыми) принято называть задачей в форме Больца; терминальные постановки (только первое слагаемое) --- в форме Майера; постановки только с интегралом (без первого слагаемого) --- в форме Лагранжа.

%Вывод первого раздела
В итоге: задачи оптимального управления являются задачами минимизации на множестве функций и могут быть решены методами классического вариационного исчисления. Однако, наличие ограничений в форме равенств (уравнения УП и ОУ) и особенно в форме неравенств (ограничения допустимых управлений и состояний) требует применения методов неклассического вариационного исчисления, к которым относятся принцип максимума Л.\=,С.~Понтрягина, метод динамического программирования Р.~Беллмана, метод моментов Н.\=,Н.~Красовского, симплекс-метод линейного программирования, метод нелинейного программирования Табака-Куо, Куна-Таккера, символьные методы решения нелинейных алгебраических (например, трансцендентных) уравнений и~т.\,п. (градиентные и методы прямого поиска).





%Часть 3 Теория решения задач на экстремум
\clearpage
\section{Теория решения задач на экстремум\label{extremum}}
Формально достаточно общие задачи по отысканию $\max$  или $\min$ функции записываются в виде $\underset{x}{\mathop{extr}}\,\,F\left( x \right)$, $x\in X$ - т.е. найти в множестве $X$ точку $x$, при которой скалярная функция векторного аргумента $F\left( x \right)$ принимает экстремальное значение. При этом точки $x={{\left( {{x}_{1}},{{x}_{2}},...{{x}_{n}} \right)}^{T}}\in X$ называют допустимыми, само множество может быть ограничено или $X={{R}^{n}}$, а задача поиска $max \,\,F\left( x \right)$ сведена к задаче $\min \,\,-F\left( x \right)$. Точку ${{x}^{*}}\in {{X}^{*}}$ такую, что $F\left( {{x}^{*}} \right)\le F\left( x\in X,\,x\ne {{x}^{*}} \right)$ называют решением задачи на $\min$ (экстремум), а $F\left( {{x}^{*}} \right)$-значением экстремума.
\par Для сложных функций в заданной области могут быть несколько таких точек (локальные экстремумы, также называемые слабыми и абсолютные экстремумы также называемые сильными)
\par Для отыскания решения задачи без ограничений необходимо:
\begin{enumerate}
\item Выписать условие экстремума: $grad\left( F\left( x \right) \right)=\frac{\partial F\left( x \right)}{\partial x}=0$ (для скалярного аргумента $\frac{df}{dx}=0$)
\item Найти решения этих уравнений - полученные решения называют стационарными точками
\item Отыскать, среди них решения задачи или доказать, что его нет. Достаточным условием решения задачи на $\max$ ($\min$) является отрицательная(положительная) определенность матрицы вторых производных $\frac{{{\partial }^{2}}F\left( x \right)}{\partial {{x}^{2}}}$ -матрицы Гессе.
\end{enumerate}

%**********
%Надо как-то выделить текст
%**********
%Пример
\vspace{\baselineskip}
\par\ExampleMy 
\begin{enumerate}
\item $\min \left( F\left( x \right) \right)=\frac{1}{2}\left( x_{1}^{2}+4x_{2}^{2} \right)$\\
$\left\{ \begin{matrix}
   \frac{\partial F}{\partial {{x}_{1}}}={{x}_{1}}  \\
   \frac{\partial F}{\partial {{x}_{2}}}=4{{x}_{2}}  \\
\end{matrix} \right.\equiv 0\to \left\{ \begin{matrix}
   {{x}_{1}}=0  \\
   {{x}_{2}}=0  \\
\end{matrix} \right.$ - положительная определенность может быть подтверждена вычислением собственных чисел или анализом всех диагональных миноров $\left( {{\Delta }_{1}}=1,{{\Delta }_{2}}=4 \right)$ - это доказывает, что $F\left( 0 \right)=0$ стационарная точка $\left( 0,0 \right)$ глобальный (абсолютный) $\min$  

\item $\underset{{{x}_{1}},{{x}_{2}}}{\mathop{\min }}\,\left( F\left( x \right) \right)=x_{1}^{2}-2{{x}_{1}}{{x}_{2}}+4x_{2}^{2}$\\ 
$\left\{ \begin{matrix}
   \frac{\partial F}{\partial {{x}_{1}}}=2{{x}_{1}}-2{{x}_{2}}=0  \\
   \frac{\partial F}{\partial {{x}_{2}}}=-2{{x}_{1}}+8{{x}_{2}}=0  \\
\end{matrix} \right.\to {{x}^{*}}={{\left( 0,0 \right)}^{T}}$
матрица Гессе $\frac{{{\partial }^{2}}F}{\partial {{x}^{2}}}=\left| \begin{matrix}
   2 & -2  \\
   -2 & 8  \\
\end{matrix} \right|$ - положительно определенная - это достаточное условие $\min \left( F\left( {{x}^{*}} \right) \right)=0$
\item $f\left( x \right)={{x}^{3}}\left( {{x}^{2}}-1 \right)\to extr$; $-1\le x\le 2$
\\$\frac{\partial f}{\partial x}=5{{x}^{4}}-3{{x}^{2}}=0\to {{x}_{1}}=0;\,\,{{x}_{2}}=\sqrt{3};\,{{x}_{3}}=\sqrt{\frac{3}{5}}$ \\$\frac{{{\partial }^{2}}F}{\partial {{x}^{2}}}=20{{x}^{2}}-6x$
\\${{\left. \frac{{{\partial }^{2}}F}{\partial {{x}^{2}}} \right|}_{{{x}_{1}}}}=0;{{\left. \frac{{{\partial }^{2}}F}{\partial {{x}^{2}}} \right|}_{{{x}_{2}}}}=6\sqrt{\frac{3}{5}}>0\to \min ;{{\left. \frac{{{\partial }^{2}}F}{\partial {{x}^{2}}} \right|}_{{{x}_{3}}}}=-6\sqrt{\frac{3}{5}}<0\to \max $
\\$f\left( -1 \right)=0,f\left( 2 \right)=24$
\end{enumerate}

В качестве точек возможного экстремума необходимо включить для анализа не только стационарные $\left( \bullet  \right)$, но еще границы допустимой области и точки возможных разрывов оптимизируемой функции.  
\\При отыскания решения задачи с ограничениями в форме равенств $X=\left\{ x\in {{R}^{n}},G\left( x \right)={{\left( {{g}_{1}}\left( x \right),{{g}_{2}}\left( x \right)...{{g}_{k}}\left( x \right) \right)}^{T}}=0 \right\}$ существует несколько методов: наиболее просты и очевидны 2: метод прямой подстановки и составление функции Лагранжа. При решении методом составления функции Лагранжа необходимо:
\begin{itemize}
\item Составить функцию $L\left( x,\lambda  \right)=F\left( x \right)+{{\lambda }^{T}}G\left( x \right)$, где $\lambda ={{\left( {{\lambda }_{1}},{{\lambda }_{2}}...{{\lambda }_{k}} \right)}^{T}}$ - вектор неопределенных множеств.
\item Выписать необходимые условия экстремума $\frac{\partial L\left( x,\lambda  \right)}{\partial x}=0,\,\,\frac{\partial L}{\partial \lambda }=0$
\item Найти стационарные точки и отыскать среди них решения задачи или доказать, что решения нет.
\end{itemize}
  
\begin{enumerate}[resume]
\item Найти стационарные точки для $F\left( x \right)=0.5\left( x_{1}^{2}+4x_{2}^{2} \right)$ при линейном ограничении на переменные $g\left( x \right)={{x}_{1}}+2{{x}_{2}}-1=0$ 
\begin{itemize}
\item $L\left( x,\lambda  \right)=\frac{1}{2}\left( x_{1}^{2}+4x_{2}^{2} \right)+\lambda \left( {{x}_{1}}+2{{x}_{2}}-1 \right)$
\item Необходимое условие $\frac{\partial L}{\partial {{x}_{1}}}={{x}_{1}}+\lambda =0\to {{x}_{1}}=-\lambda ;$ $\frac{\partial L}{\partial {{x}_{2}}}=4{{x}_{2}}+2\lambda =0\to {{x}_{2}}=-\frac{1}{2}\lambda $, $\frac{\partial L}{\partial \lambda }={{x}_{1}}+2{{x}_{2}}-1=0\to \lambda =0.5$
\item Cтационарная точка $\left( {{x}_{1}},{{x}_{2}} \right)=\left( 0.5,\,0.25 \right)$
\end{itemize}


$\frac{{{\partial }^{2}}L}{\partial x_{1}^{2}}=1;$ $\frac{{{\partial }^{2}}L}{\partial {{x}_{1}}\partial {{x}_{2}}}=0;$ $\frac{{{\partial }^{2}}L}{\partial {{x}_{1}}\partial \lambda }=1;$ 
\\$\frac{{{\partial }^{2}}L}{\partial {{x}_{2}}\partial {{x}_{1}}}=0;$ $\frac{{{\partial }^{2}}L}{\partial x_{2}^{2}}=4;$ $\frac{{{\partial }^{2}}L}{\partial {{x}_{2}}\partial \lambda }=2;$
\\$\frac{{{\partial }^{2}}L}{\partial \lambda \partial {{x}_{1}}}=1;$ $\frac{{{\partial }^{2}}L}{\partial \lambda \partial {{x}_{2}}}=2;$ $\frac{{{\partial }^{2}}L}{\partial {{\lambda }^{2}}}=2;$
\\$\frac{{{\partial }^{2}}L}{\partial X,L}=\left| \begin{matrix}
   1 & 0 & 1  \\
   0 & 4 & 2  \\
   1 & 2 & 0  \\
\end{matrix} \right|=1\left| \begin{matrix}
   0 & 4  \\
   1 & 2  \\
\end{matrix} \right|-2\left| \begin{matrix}
   1 & 0  \\
   1 & 2  \\
\end{matrix} \right|=-8$
\\$F=\frac{1}{2}\left( {{\left( \frac{1}{2} \right)}^{2}}+4{{\left( \frac{1}{4} \right)}^{2}} \right)=\frac{1}{4}=F\left( {{x}^{*}} \right)$
\\$F=\frac{1}{2}\left( x_{1}^{2}+4x_{2}^{2} \right)=C$ 
\\${{x}_{1}}=\pm \frac{\sqrt{2}}{2}\approx 0.7$; ${{x}_{2}}=\pm \frac{\sqrt{2}}{4}\approx 0.35$
\end{enumerate}
%
\par Задачи оптимизации без ограничений и с ограничением в форме равенств называются классическими и могут быть решены автоматически. Все остальные - неклассические; очень редко могут решаться аналитически. Для их решения используют алгоритм Куна-Таккера, градиентные методы, симплексные алгоритмы и методы прямого поиска.
\par Стационарные точки экстремальной задачи находятся путем решения уравнений вида $Q\left( x \right)=0$, рекуррентным методом Ньютона. Последовательные приближения осуществляют по формуле ${{x}_{n+1}}={{x}_{n}}-\frac{Q\left( {{x}_{n}} \right)}{\left( \frac{dQ\left( {{x}_{n}} \right)}{dx} \right)}$, геометрический смысл который состоит в том, что точке ${{x}_{n+1}}$ вычисляется как пересечение оси абсцисс с касательной к кривой $y=Q\left( x \right)$ в точке ${{x}_{n}}$ 
\begin{enumerate}[resume]
\item Найти численное значение корня уравнения $x-\sin x=\frac{\pi }{2}$.
\\Составляем рекуррентную формулу ${{x}_{n+1}}={{x}_{n}}-\frac{{{x}_{n}}-\sin {{x}_{n}}-\frac{\pi }{2}}{\left( 1-\cos x \right)}$ при ${{x}_{0}}=2.4$ . В итоге получается последовательность $2.4;$ $2.31;$ $2.3099;$ $2.309884$ 
\end{enumerate}


\clearpage
\section{Основы вариационного исчисления\label{variations}}
\subsection{Основные понятия\label{variations:general}}
Функционал - числовая скалярная функция, определяемая на множестве функцией: $y=f\left( x \right)$  -функция от аргумента. $J\left( x \right)=\int\limits_{0}^{T}{F\left( x,\dot{x},t \right)}dt$ - функция от функций  (скалярная оценка различных функций).
\par Каждая функция $x\left( t \right)$ является точкой функционального пространства. Пусть эта функция однозначна, непрерывна и дифференцируема на рассматриваемом интервале - такие функции называются гладкими. Если значения функции соответствуют заданным в граничных точках их называют допустимыми. И тогда задача заключается в выборе среди допустимых такой где функционал достигает наименьшего значения $\underset{x\in \Omega }{\mathop{\min }}\,\left( J\left( x \right) \right)$.
Решением таких задач занимается вариационное исчисление. Аналог дифференциального исчисления для функций. 
\par И так для функций условием экстремума является:
\[{{\left. d\varphi \left( x \right) \right|}_{x={{x}_{{}}}}}=0,\frac{d\varphi \left( x \right)}{dx}=0\to \partial J\left( x \right)=0\,\,\,\left( * \right)\] 
\[{{d}^{2}}\varphi \left( x \right)\ne 0\to {{\partial }^{2}}J\left( x \right)\ne 0\,\,\,\,\left( ** \right)\]
Из $\left( * \right)$  условия выводится уравнение Эйлера: \[\frac{\partial F}{\partial x}-\frac{d}{dt}\left( \frac{\partial F}{\partial \dot{x}} \right)=0\]
Все функции удовлетворяющие этому уравнению, называются экстремалями. Если они проходят через граничные точки,  
то они называют допустимыми экстремалями. Из уравнения $\left( ** \right)$ выводят условия Лежандра $\frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}^{2}}}\ne 0$ 
%Пример
\vspace{\baselineskip}
\par\ExampleMy~ 
\begin{enumerate}
\item $J=\int\limits_{0}^{1}{{{{\dot{x}}}^{2}}dt\to extr,\,x\left( 0 \right)}=0,\,x\left( 1 \right)=1$
\\$F={{\dot{x}}^{2}}\to \frac{\partial F}{\partial x}=0,\,\,\frac{\partial F}{\partial \dot{x}}=2\dot{x}$
\\Уравнение Эйлера: $\frac{\partial F}{\partial x}-\frac{d}{dt}\left( \frac{\partial F}{\partial \dot{x}} \right)=0\to 0-\frac{d}{dt}\left( 2\dot{x} \right)=0$
\\$\ddot{x}=0,\dot{x}={{C}_{1}},x={{C}_{1}}t+{{C}_{2}};$
\\$x\left( 0 \right)={{C}_{2}}=0,\,x\left( 1 \right)={{C}_{1}}+{{C}_{2}}=1\to {{C}_{1}}=1$
\\Допустимая экстремаль: $\hat{x}=t$
\\Условие Лежандра $\frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}^{2}}}=2>0\to \min $ величина которого будет равна ${{J}_{\min }}={{\int\limits_{0}^{1}{\left( {\dot{\hat{x}}} \right)}}^{2}}dt={{\int\limits_{0}^{1}{\left( {\dot{t}} \right)}}^{2}}dt={{\int\limits_{0}^{1}{\left( 1 \right)}}^{2}}dt=\left. t \right|_{0}^{1}=1$
\item Найти уравнение выхода $x\left( t \right)$  и характеристический полином СУ, для которой $J\left( \infty  \right)=\int\limits_{0}^{\infty }{\left( {{a}_{0}}{{x}^{2}}+{{a}_{1}}{{{\dot{x}}}^{2}} \right)}dt\to \min$, при условиях ${{a}_{0}}>0,\,{{a}_{1}}>0,\,x\left( 0 \right)={{x}_{0}},x\left( \infty  \right)=0$
\\$F={{a}_{0}}{{x}^{2}}+{{a}_{1}}{{\dot{x}}^{2}},\frac{\partial F}{\partial x}=2{{a}_{0}}x,\frac{\partial F}{\partial \dot{x}}=2{{a}_{1}}\dot{x}$
\\Уравнение Эйлера: $2{{a}_{0}}x-\frac{d}{dt}\left( 2{{a}_{1}}\dot{x} \right)=0$, $\ddot{x}-\frac{{{a}_{0}}}{{{a}_{1}}}x=0$, ${{\lambda }^{2}}-\frac{{{a}_{0}}}{{{a}_{1}}}=0$, ${{\lambda }_{12}}=\pm \sqrt{\frac{{{a}_{0}}}{{{a}_{1}}}}$, 
\\$x\left( t \right)={{C}_{1}}{{e}^{\sqrt{\frac{{{a}_{0}}}{{{a}_{1}}}}}}+{{C}_{2}}{{e}^{-\sqrt{\frac{{{a}_{0}}}{{{a}_{1}}}}}}$
\\$t=0;\,{{x}_{0}}={{C}_{1}}+{{C}_{2}}$
\\$t=\infty ;0=C_{1}^{-\infty }\to {{C}_{1}}=0$, а ${{C}_{2}}={{x}_{0}}$
\par Допустимая экстремаль $\hat{x}={{x}_{0}}{{e}^{-\sqrt{\frac{{{a}_{0}}}{{{a}_{1}}}}t}}$
\\Условие Лежандра: $\frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}^{2}}}=2{{a}_{1}}>0$ - условия $\min $ выполнены.
\par Характеристический полином системы $D\left( p \right)=p+\sqrt{\frac{{{a}_{0}}}{{{a}_{1}}}}$ 
\end{enumerate}
Обобщим результаты в 2 направлениях:
\begin{itemize}
\item Многомерный случай
\\$X$-векторная функция $={{\left( x_{1}^{\left( t \right)},x_{2}^{\left( t \right)},...x_{n}^{\left( t \right)} \right)}^{T}}$ 
\\$J\left( x \right)=\int\limits_{{{t}_{0}}}^{{{t}_{K}}}{F\left( x,\dot{x},t \right)}dt\to extr$, $\min $;
\\${{x}_{i}}\left( {{t}_{0}} \right)={{x}_{io}}$, ${{x}_{i}}\left( {{t}_{k}} \right)={{x}_{ik}}$
\\Тогда первое необходимое условие (уравнение Эйлера) - система: $\frac{\partial F}{\partial {{x}_{i}}}-\frac{d}{dt}\left( \frac{\partial F}{\partial {{{\dot{x}}}_{i}}} \right)=0,i=\overline{1,n}$ 
\\Второе условие требует анализа матрицы вторых частных производных:
\[\left\| \begin{array}{*{35}{l}}
   \frac{{{\partial }^{2}}F}{\partial \dot{x}_{1}^{2}} & \frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}_{1}}\partial {{{\dot{x}}}_{2}}} & ... & \frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}_{1}}\partial {{{\dot{x}}}_{n}}}  \\
   \frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}_{2}}\partial {{{\dot{x}}}_{1}}} & \frac{{{\partial }^{2}}F}{\partial \dot{x}_{2}^{2}} & ... & \frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}_{2}}\partial {{{\dot{x}}}_{n}}}  \\
   \frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}_{n}}\partial {{{\dot{x}}}_{1}}} & \frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}_{n}}\partial {{{\dot{x}}}_{2}}} & ... & \frac{{{\partial }^{2}}F}{\partial \dot{x}_{n}^{2}}  \\
\end{array} \right\|\]
\\Для \underline{минимума}, все диагональные миноры \underline{должны быть $\ge 0$}, для \underline{$\max \le 0$}. Строгие неравенства дают и \underline{достаточность} условий.
%Непонятно что это пункт или часть случая
\\
\\
\\$J=\int\limits_{0}^{1}{\left( {{x}_{1}}{{x}_{2}}+{{{\dot{x}}}_{1}}{{{\dot{x}}}_{2}} \right)}dt\to extr$, ${{x}_{1}}\left( 0 \right)={{x}_{2}}\left( 0 \right)=1$, ${{x}_{1}}\left( 1 \right)=e$, ${{x}_{2}}\left( 1 \right)=\frac{1}{e}$ 
\\$X=\left( {{x}_{1}},{{x}_{2}} \right)$, $F={{x}_{1}}{{x}_{2}}+{{\dot{x}}_{1}}{{\dot{x}}_{2}}$
\\$\frac{\partial F}{\partial {{x}_{1}}}={{x}_{2}}$ $\frac{\partial F}{\partial {{{\dot{x}}}_{1}}}={{\dot{x}}_{2}}$ $\to $ $\frac{\partial F}{\partial {{x}_{1}}}-\frac{d}{dt}\left( \frac{\partial F}{\partial {{{\dot{x}}}_{1}}} \right)=0$: ${{\ddot{x}}_{2}}-{{x}_{2}}=0$ $\to $ ${{x}_{2}}={{C}_{1}}{{e}^{t}}+{{C}_{2}}{{e}^{-t}}$
\\$\frac{\partial F}{\partial {{x}_{2}}}={{x}_{1}}$, $\frac{\partial F}{\partial {{{\dot{x}}}_{2}}}={{\dot{x}}_{1}}$ $\to$ $\frac{\partial F}{\partial {{x}_{2}}}-\frac{d}{dt}\left( \frac{\partial F}{\partial {{{\dot{x}}}_{2}}} \right)=0$: ${{\ddot{x}}_{1}}-{{x}_{1}}=0$ $\to$ ${{x}_{1}}={{C}_{3}}{{e}^{t}}+{{C}_{4}}{{e}^{-t}}$
\\Подставив начальные и конечные условия получим ${{\hat{x}}_{1}}={{e}^{t}}$, ${{\hat{x}}_{2}}={{e}^{-t}}$
$\left\| \begin{matrix}
   \frac{{{\partial }^{2}}F}{\partial \dot{x}_{1}^{2}} & \frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}_{1}}\partial {{{\dot{x}}}_{2}}}  \\
   \frac{{{\partial }^{2}}F}{\partial {{{\dot{x}}}_{2}}\partial {{{\dot{x}}}_{1}}} & \frac{{{\partial }^{2}}F}{\partial \dot{x}_{2}^{2}}  \\
\end{matrix} \right\|=\left\| \begin{matrix}
   0 & 1  \\
   1 & 0  \\
\end{matrix} \right\|$ $\to $  ${{\Delta }_{1}}=0$, ${{\Delta }_{2}}=-1$ $\to $ имеет место \underline{$\max $}
\\${{J}_{\max }}=\int\limits_{0}^{1}{\left( {{e}^{t}}{{e}^{-t}}+{{e}^{t}}\left( {{e}^{-t}} \right) \right)}dt=0$
\item Задача со старшими производными:
\\$J\left( x \right)=\int\limits_{{{t}_{0}}}^{{{t}_{k}}}{F\left( x,\dot{x},\ddot{x},...\overset{n}{\mathop{x}}\,,t \right)}dt$
\\$x\left( {{t}_{0}} \right)={{x}_{0}},\dot{x}\left( {{t}_{0}} \right)={{x}_{0}},...\overset{\left( n-1 \right)}{\mathop{x}}\,\left( {{t}_{0}} \right)=\overset{\left( n-1 \right)}{\mathop{{{x}_{0}}}}\,$
\\$x\left( {{t}_{k}} \right)={{x}_{0}},\dot{x}\left( {{t}_{k}} \right)={{x}_{k}},...\overset{\left( n-1 \right)}{\mathop{x}}\,\left( {{t}_{k}} \right)=\overset{\left( n-1 \right)}{\mathop{{{x}_{k}}}}\,$
Существует 2 способа решения:
\begin{enumerate}
\item Рассматривается векторная функция, составляемая из исходной $x\left( t \right)$ и её $\left( n-1 \right)$ производной - т.е. задача, как многомерный случай
\item Уравнение Эйлера преобразуется в уравнение Эйлера-Пуассона:
$\frac{\partial F}{\partial x}-\frac{d}{dt}\left( \frac{\partial F}{\partial \dot{x}} \right)+\frac{{{\partial }^{2}}}{\partial {{t}^{2}}}\left( \frac{\partial F}{\partial \ddot{x}} \right)-...+{{\left( -1 \right)}^{n}}\frac{{{d}^{n}}}{d{{t}^{n}}}\left( \frac{\partial F}{\partial \overset{\left( n \right)}{\mathop{x}}\,} \right)=0$,
\\Условие Лежандра: $\frac{{{\partial }^{2}}F}{{{\left( \partial \overset{\left( n \right)}{\mathop{x}}\, \right)}^{2}}}\ne 0$
\\ $J\left( x \right)=\int\limits_{0}^{1}{{{{\ddot{x}}}^{2}}}dt\to extr$, $x\left( 0 \right)=\dot{x}\left( 0 \right)=0$, $x\left( 1 \right)=0$, $\dot{x}\left( 1 \right)=1$
\\$F={{\ddot{x}}^{2}}$: $\frac{\partial F}{\partial x}-\frac{d}{dt}\left( \frac{\partial F}{\partial \dot{x}} \right)+\frac{{{\partial }^{2}}}{\partial {{t}^{2}}}\left( \frac{\partial F}{\partial \ddot{x}} \right)=0$
\\$0-0+\frac{{{\partial }^{2}}}{\partial {{t}^{2}}}\left( 2\ddot{x} \right)=0$ $\to $ $\overset{\left( 4 \right)}{\mathop{x}}\,=0$, $\overset{\left( 3 \right)}{\mathop{x}}\,={{C}_{1}}$, $\overset{\left( 2 \right)}{\mathop{x}}\,={{C}_{1}}t+{{C}_{2}}$, $\dot{x}=\frac{1}{2}{{C}_{1}}{{t}^{2}}+{{C}_{2}}t+{{C}_{3}}$
\\$x=\frac{1}{6}{{C}_{1}}{{t}^{3}}+\frac{1}{2}{{C}_{2}}{{t}^{2}}+{{C}_{3}}t+{{C}_{4}}$, 
\\$t\left( 0 \right):\,0={{C}_{4}},\,0={{C}_{3}}$
\\$t\left( 1 \right):\frac{1}{6}{{C}_{1}}+\frac{1}{2}{{C}_{2}}=0,\frac{1}{2}{{C}_{1}}+{{C}_{2}}=0$ $\to $ ${{C}_{1}}=6,\,{{C}_{2}}=-2$
\\$\hat{x}={{t}^{3}}-{{t}^{2}}$, $\ddot{\hat{x}}=6t-2$ 
\\${{J}_{\min }}=\int\limits_{0}^{1}{{{\left( 6t-2 \right)}^{2}}}dt=\left. 12{{t}^{3}} \right|_{0}^{1}-\left. 12{{t}^{2}} \right|_{0}^{1}+\left. 4t \right|_{0}^{1}=4$
\end{enumerate}
\end{itemize}

\subsection{Задачи с нефиксированными границами\label{variations:floating_ends}}
Как для начального момента времени (левого конца) так и для конечного момента времени (правого конца) могут быть следующие варианты: (для удобства все примеры для правого конца)
\begin{itemize}
\item Задача со свободным правым концом ${{t}_{k}}=\operatorname{var}$, $x\left( {{t}_{k}} \right)=\operatorname{var}$
\item Задача с подвижным правым концом ${{t}_{k}}=T$, $x\left( {{t}_{k}} \right)=\operatorname{var}$
\item Задача со скользящим правым концом ${{t}_{k}}=T$-не задано, $x\left( {{t}_{k}} \right)$ не задано, но определена их взаимосвязь $\psi \left( t \right)$
\end{itemize}
\par В этих случаях (когда отсутствует соответствующее граничное условие) необходимым условием экстремума, кроме уравнения Эйлера $\frac{\partial F}{\partial x}-\frac{d}{dt}\left( \frac{\partial F}{\partial \dot{x}} \right)=0$, становятся \underline{условия трансверсальности}:
\\$\left\{ \begin{array}{*{35}{l}}
   {{\left. \left( F-\frac{\partial F}{\partial \dot{x}}\dot{x} \right) \right|}_{{{t}_{k}}}}=0$ - если не задано ${{t}_{k}}$ и $x\left( {{t}_{k}} \right)$  
   $\\{{\left. \frac{\partial F}{\partial \dot{x}} \right|}_{{{t}_{k}}}}=0$ - если не задано $x\left( {{t}_{k}} \right)$
   $\\{{\left. \left( F-\frac{\partial F}{\partial \dot{x}}\left( \dot{x}-\dot{\psi } \right) \right) \right|}_{{{t}_{k}}}}=0$ - если конец скользящий   
$\end{array} \right.$
\\В векторном случае: $X=\left( {{x}_{1}}\left( t \right),{{x}_{2}}\left( t \right)...{{x}_{n}}\left( t \right) \right)$ необходимым условием достижения экстремума является система уравнений:
\\$\left\{ \begin{array}{*{35}{l}}
   \frac{\partial F}{\partial {{x}_{i}}}-\frac{d}{dt}\left( \frac{\partial F}{\partial {{x}_{i}}} \right)=0,\,i=\overline{1,n}$ - уравнение Эйлера   
   $ \\   {{\left. \left( F-\sum\limits_{i=1}^{n}{\frac{\partial F}{\partial {{{\dot{x}}}_{i}}}{{{\dot{x}}}_{i}}} \right) \right|}_{{{t}_{0}}}}=0;\,\,{{\left. \left( F-\sum\limits_{i=1}^{n}{\frac{\partial F}{\partial {{{\dot{x}}}_{i}}}{{{\dot{x}}}_{i}}} \right) \right|}_{{{t}_{k}}}}=0$ 
   $\\{{\left. \frac{\partial F}{\partial {{{\dot{x}}}_{i}}} \right|}_{{{t}_{0}}}}=0,\,i=\overline{1,n};\,\,{{\left. \frac{\partial F}{\partial {{{\dot{x}}}_{i}}} \right|}_{{{t}_{k}}}}=0,\,i=\overline{1,n}$ 
$\\\end{array} \right.$
\\Вторая и третья строки системы условия трансверсальности с соответвующим незаданным граничным условием.
\\Максимальное количество условий трансверсальности $2n+2$.
\\
\\
\ExampleMy 



 

 


\subsection{Оптимизация функционалов с ограничениями в форме равенств\label{variations:conditional_extremum}}


\clearpage
\section{Синтез оптимальных систем\label{synthesis}}
\subsection{Общий случай\label{synthesis:general}}

\subsection{Принцип максимума Понтрягина\label{synthesis:principle_of_maximum}}

\subsection{Синтез оптимальных по быстродействию систем\label{synthesis:fastest}}

\subsection{Динамическое программирование Беллмана\label{synthesis:dyn_prog}}

\clearpage
\section{Синтез оптимальных стохастических систем\label{stochastic}}
\subsection{Основные понятия\label{stochastic:general}}

\subsection{Синтез управления с минимальной дисперсией ошибки\label{stochastic:min_error_dispersion}}

\subsection{Фильтры\label{stochastic:filters}}

\subsection{Наблюдатели состояния\label{stochastic:observers}}


\end{document}




